{
    "inline": {
        "_source": {
            "excludes": [
                "complete_names"
            ]
        },
        "query": {
            "function_score": {
                "query": {
                    "bool": {
                        "must": {
                            "dis_max": {
                                "queries": [
                                    {
                                        "simple_query_string": {
                                            "query": "{{name}}",
                                            "fields": [
                                                "name^3",
                                                "alternateName"
                                            ]
                                        }
                                    },
                                    {
                                        "match_phrase": {
                                            "name": "{{name}}"
                                        }
                                    },
                                    {
                                        "term": {
                                            "ids": "{{name}}"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                "functions": [
                    {
                        "filter": {
                            "match_phrase_prefix": {
                                "name": "{{name}}"
                            }
                        },
                        "weight": 200
                    },
                    {
                        "filter": {
                            "multi_match": {
                                "query": "{{name}}",
                                "fields": [
                                    "name^3",
                                    "alternateName"
                                ],
                                "operator": "and"
                            }
                        },
                        "weight": 10
                    },
                    {
                        "filter": {
                            "match": {
                                "active": false
                            }
                        },
                        "weight": 0.8
                    },
                    {
                        "filter": {
                            "terms": {
                                "source": [
                                    "ccew",
                                    "ccni",
                                    "oscr"
                                ]
                            }
                        },
                        "weight": 5
                    },
                    {
                        "script_score": {
                            "script": {
                                "source": "if((doc['latestIncome'].size()==0) || Objects.isNull(doc['latestIncome'].value) || (doc['latestIncome'].value <= 1)){1}else{Math.log(doc['latestIncome'].value)}"
                            }
                        }
                    }
                ]
            }
        }
    },
    "params": {
        "name": "term"
    }
}